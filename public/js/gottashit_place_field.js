function getLocation_field(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showPosition_field)}function showPosition_field(o){$("#get-my-location").attr("data-latitude",o.coords.latitude),$("#get-my-location").attr("data-longitude",o.coords.longitude),$("#get-my-location").show()}!function(o){function e(){var e=GottaShit.lat,t=GottaShit.lon,n=GottaShit.latLonInitial,i=new google.maps.LatLng(e,t),m={zoom:6,center:i,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_BOTTOM},mapTypeControl:!1,streetViewControl:!1};c=new google.maps.Map(document.getElementById("place-map"),m),r=new google.maps.Geocoder,d=new google.maps.Marker({map:c,draggable:!0}),o(".my-location").on("click","a",l),google.maps.event.addListener(d,"dragend",function(o){d.setMap(c),g=o.latLng,d.setPosition(g),s("latLng",g,!1,g)}),google.maps.event.addListener(c,"click",function(o){d.setMap(c);var e=o.latLng;d.setPosition(e),d.setVisible(!0),c.setCenter(e),s("latLng",e,!1,e),a(e)}),1==n&&(oldLocation=new google.maps.LatLng(e,t),d.setPosition(oldLocation),c.setZoom(17)),o("#place-map-error").hide()}function t(o,e){e.setMap(c),c.fitBounds(o.viewport),e.setPosition(o.location)}function n(e,t){o("#place-loc").val(e),a(t)}function a(e){o("#geo_lat").val(e.lat()),o("#geo_lng").val(e.lng())}function l(){var e=new google.maps.LatLng(o(this).data("latitude"),o(this).data("longitude"));c.setCenter(e),c.setZoom(17),d.setPosition(e),d.setVisible(!0),c.setCenter(e),s("latLng",e,!1,e),a(e)}function s(e,l,s,i){s=void 0!==s&&s,request={},request[e]=l,r.geocode(request,function(r,c){o("#place-map-error").html(""),o("#place-map-error").hide(),c==google.maps.GeocoderStatus.OK?r[0]?(n(r[0].formatted_address,r[0].geometry.location),i=void 0!==i&&i,i&&a(i),s&&t(r[0].geometry,d)):(o("#place-map-error").html("Perdona, algo anda mal. ¡Inténtalo de nuevo!"),o("#place-map-error").show()):"address"==e?(o("#place-map-error").html("Perdona, no podemos encontrar "+l+". Intenta una busqueda diferente o localízate haciendo clic en el mapa."),o("#place-map-error").show(),o("#geo_lat").val(""),o("#geo_lng").val("")):(o("#place-map-error").html("Guau... ¡Estás en un sitio único! Tendrás que introducir manualmente el nombre de ese lugar."),o("#place-map-error").show(),n("",l))})}function i(){var e=document.getElementById("place-loc"),t={types:[],componentRestrictions:{country:"es"}},n=new google.maps.places.Autocomplete(e,t);n.bindTo("bounds",c),google.maps.event.addListener(n,"place_changed",function(){d.setVisible(!1);var e=n.getPlace();if(!e.geometry)return void o("#place-map-error").html("Autocomplete's returned place contains no geometry.");c.setCenter(e.geometry.location),c.setZoom(17),d.setPosition(e.geometry.location),d.setVisible(!0),a(e.geometry.location);var t="";e.address_components&&(t=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),o("#place-loc").val(t)})}var r,c,d,g;o(document).ready(function(){e(),i(),o("#place-loc").keydown(function(o){13==o.which&&o.preventDefault()}),o("#place-loc").keyup(function(e){""==o("#place-loc").val()&&(d.setVisible(!1),o("#geo_lat").val(""),o("#geo_lng").val(""))})})}(jQuery),getLocation_field();
