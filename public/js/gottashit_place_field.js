function getLocation_field(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showPosition_field)}function showPosition_field(e){$("#get-my-location").attr("data-latitude",e.coords.latitude),$("#get-my-location").attr("data-longitude",e.coords.longitude),$("#get-my-location").show()}!function(e){var o,t,a,n;function l(o,t){e("#place-loc").val(o),s(t)}function s(o){e("#geo_lat").val(o.lat()),e("#geo_lng").val(o.lng())}function i(){var o=new google.maps.LatLng(e(this).data("latitude"),e(this).data("longitude"));t.setCenter(o),t.setZoom(17),a.setPosition(o),a.setVisible(!0),t.setCenter(o),r("latLng",o,!1,o),s(o)}function r(n,i,r,c){r=void 0!==r&&r,request={},request[n]=i,o.geocode(request,function(o,d){e("#place-map-error").html(""),e("#place-map-error").hide(),d==google.maps.GeocoderStatus.OK?o[0]?(l(o[0].formatted_address,o[0].geometry.location),(c=void 0!==c&&c)&&s(c),r&&function(e,o){o.setMap(t),t.fitBounds(e.viewport),o.setPosition(e.location)}(o[0].geometry,a)):(e("#place-map-error").html("Perdona, algo anda mal. ¡Inténtalo de nuevo!"),e("#place-map-error").show()):"address"==n?(e("#place-map-error").html("Perdona, no podemos encontrar "+i+". Intenta una busqueda diferente o localízate haciendo clic en el mapa."),e("#place-map-error").show(),e("#geo_lat").val(""),e("#geo_lng").val("")):(e("#place-map-error").html("Guau... ¡Estás en un sitio único! Tendrás que introducir manualmente el nombre de ese lugar."),e("#place-map-error").show(),l("",i))})}e(document).ready(function(){var l,c,d,g,m,p;l=GottaShit.lat,c=GottaShit.lon,d=GottaShit.latLonInitial,g={zoom:6,center:new google.maps.LatLng(l,c),mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_BOTTOM},mapTypeControl:!1,streetViewControl:!1},t=new google.maps.Map(document.getElementById("place-map"),g),o=new google.maps.Geocoder,a=new google.maps.Marker({map:t,draggable:!0}),e(".my-location").on("click","a",i),google.maps.event.addListener(a,"dragend",function(e){a.setMap(t),n=e.latLng,a.setPosition(n),r("latLng",n,!1,n)}),google.maps.event.addListener(t,"click",function(e){a.setMap(t);var o=e.latLng;a.setPosition(o),a.setVisible(!0),t.setCenter(o),r("latLng",o,!1,o),s(o)}),1==d&&(oldLocation=new google.maps.LatLng(l,c),a.setPosition(oldLocation),t.setZoom(17)),e("#place-map-error").hide(),m=document.getElementById("place-loc"),(p=new google.maps.places.Autocomplete(m,{types:[],componentRestrictions:{country:"es"}})).bindTo("bounds",t),google.maps.event.addListener(p,"place_changed",function(){a.setVisible(!1);var o=p.getPlace();if(o.geometry){t.setCenter(o.geometry.location),t.setZoom(17),a.setPosition(o.geometry.location),a.setVisible(!0),s(o.geometry.location);var n="";o.address_components&&(n=[o.address_components[0]&&o.address_components[0].short_name||"",o.address_components[1]&&o.address_components[1].short_name||"",o.address_components[2]&&o.address_components[2].short_name||""].join(" ")),e("#place-loc").val(n)}else e("#place-map-error").html("Autocomplete's returned place contains no geometry.")}),e("#place-loc").keydown(function(e){13==e.which&&e.preventDefault()}),e("#place-loc").keyup(function(o){""==e("#place-loc").val()&&(a.setVisible(!1),e("#geo_lat").val(""),e("#geo_lng").val(""))})})}(jQuery),getLocation_field();
